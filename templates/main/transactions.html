{% extends 'main/base.html' %}
{% load trade_extras %}

{% block title %}Order History{% endblock %}

{% block content %}
<div class="mb-10 flex justify-between items-end">
  <div>
    <h1 class="text-3xl font-extrabold tracking-tight mb-2">Order History</h1>
    <p class="text-gray-500">A detailed log of your trading activities.</p>
  </div>
</div>

<div class="glass rounded-[40px] overflow-hidden card-shadow">
  <table class="w-full text-left">
    <thead>
      <tr class="bg-white/5 text-[8px] md:text-[10px] font-black uppercase tracking-wider text-gray-500">
        <th class="px-2 md:px-8 py-4">Instrument</th>
        <th class="px-2 md:px-8 py-4">Type</th>
        <th class="px-2 md:px-8 py-4 text-center">Qty</th>
        <th class="px-2 md:px-8 py-4">Execution Price</th>
        <th class="px-2 md:px-8 py-4">Total Value</th>
        <th class="px-2 md:px-8 py-4 text-right">Timestamp</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-white/5">
      {% for tx in transactions %}
      <tr class="group hover:bg-white/[0.02]: transition">
        <td class="px-2 md:px-8 py-4">
          <p class="font-extrabold text-[11px] md:text-sm leading-tight">{{ tx.stock.symbol }}</p>
          <p class="text-[8px] text-gray-500 uppercase font-medium hidden sm:block">{{ tx.stock.name }}</p>
        </td>
        <td class="px-2 md:px-8 py-4">
          <span
            class="inline-block px-1.5 py-0.5 rounded-full text-[8px] font-black {% if tx.transaction_type == 'BUY' %}bg-groww/10 text-groww{% else %}bg-red-500/10 text-red-500{% endif %}">
            {{ tx.transaction_type }}
          </span>
        </td>
        <td class="px-2 md:px-8 py-4 font-bold text-[11px] md:text-sm text-center">{{ tx.quantity }}</td>
        <td class="px-2 md:px-8 py-4 font-bold text-[11px] md:text-sm">₹{{ tx.price|floatformat:1 }}</td>
        <td class="px-2 md:px-8 py-4 font-extrabold text-[11px] md:text-sm">
          ₹{% with total=tx.quantity|multiply:tx.price %}{{ total|floatformat:1 }}{% endwith %}
        </td>
        <td
          class="px-2 md:px-8 py-4 text-right text-[8px] md:text-[10px] font-black text-gray-600 uppercase tracking-tight">
          {{ tx.timestamp|date:"d M Y" }}
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="6" class="px-8 py-20 text-center">
          <p class="text-gray-500 font-bold">No orders placed yet.</p>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}